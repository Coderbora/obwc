import{_ as s,F as e}from"./DataTable.3bd407d9.js";import{J as t}from"./index.e7e2ce56.js";import{d as a,o as d,c as l,a as n,n as o,A as i,F as r,e as u,g as c,t as m,i as p,E as g,B as f,h as b,f as h,b as y}from"./vendor.9fbad299.js";var k=a({name:"StaffRoundUpdate",props:{roundProp:{type:Object,default:()=>null}},emits:["update:round"],data:()=>({round:null,userKeyword:"",users:[],selectedUser:null,judgingTypeId:t.Mappers,title:"",link:""}),computed:{mappersPick:()=>t.Mappers,playersPick:()=>t.Players},watch:{roundProp(s){this.round=s?{submissionsStartedAt:this.$formatDate(s.submissionsStartedAt),submissionsEndedAt:this.$formatDate(s.submissionsStartedAt),judgingStartedAt:this.$formatDate(s.submissionsStartedAt),judgingEndedAt:this.$formatDate(s.submissionsStartedAt),resultsAt:this.$formatDate(s.submissionsStartedAt),judgeToRounds:[...s.judgeToRounds],songs:[...s.songs]}:null}},methods:{getJudgingTypeName:s=>t[s],async search(){const{data:s}=await this.$http.get("/api/users?user="+this.userKeyword);this.users=s},addJudge(){if(this.round){if(!this.selectedUser)return this.$store.dispatch("addToastMessage","Select an user");this.round.judgeToRounds.push({user:this.selectedUser,judgingTypeId:this.judgingTypeId}),this.users=[]}},removeJudge(s){var e;null==(e=this.round)||e.judgeToRounds.splice(s,1)},addSong(){if(this.round)return this.title&&this.link?void this.round.songs.push({title:this.title,link:this.link}):this.$store.dispatch("addToastMessage","Fill the blanks")},removeSong(s){var e;null==(e=this.round)||e.songs.splice(s,1)},async update(){const{data:s}=await this.$http.put(`/api/staff/rounds/${this.roundProp.id}`,this.round);this.$emit("update:round",s)}}});const v={class:"modal fade",tabindex:"-1"},S={class:"modal-dialog modal-xl"},j={class:"modal-content"},A=n("div",{class:"modal-header"},[n("h5",{class:"modal-title"}," Update Round (dates are UTC) "),n("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),T={key:0,class:"modal-body"},U={class:"container"},D={class:"row mb-2"},J={class:"col-sm-6"},R={class:"form-group"},E=n("label",null,"Submissions Start Date",-1),$={class:"col-sm-6"},C={class:"form-group"},P=n("label",null,"Submissions End Date",-1),w={class:"col-sm-6"},V={class:"form-group"},x=n("label",null,"Judging Start Date",-1),I={class:"col-sm-6"},K={class:"form-group"},M=n("label",null,"Judging End Date",-1),_={class:"col-sm-6"},F={class:"form-group"},N=n("label",null,"Results Date",-1),B=n("hr",null,null,-1),O={class:"row mb-2"},q={class:"col-sm"},z=n("p",null,"Judges",-1),G=n("i",{class:"fas fa-times text-danger"},null,-1),H={class:"input-group"},L=n("i",{class:"fas fa-search"},null,-1),Q={class:"form-group"},W={class:"form-check form-check-inline"},X=n("label",{class:"form-check-label",for:"mappersPick"},"Mapper",-1),Y={class:"form-check form-check-inline"},Z=n("label",{class:"form-check-label",for:"playersPick"},"Player",-1),ss=n("hr",null,null,-1),es={class:"row"},ts={class:"col-sm"},as=n("p",null,"Songs",-1),ds=n("i",{class:"fas fa-times text-danger"},null,-1),ls={class:"modal-footer"},ns=n("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);k.render=function(s,e,t,a,h,y){return d(),l("div",v,[n("div",S,[n("div",j,[A,s.round?(d(),l("div",T,[n("div",U,[n("div",D,[n("div",J,[n("div",R,[E,o(n("input",{"onUpdate:modelValue":e[1]||(e[1]=e=>s.round.submissionsStartedAt=e),type:"datetime-local",class:"form-control"},null,512),[[i,s.round.submissionsStartedAt]])])]),n("div",$,[n("div",C,[P,o(n("input",{"onUpdate:modelValue":e[2]||(e[2]=e=>s.round.submissionsEndedAt=e),type:"datetime-local",class:"form-control"},null,512),[[i,s.round.submissionsEndedAt]])])]),n("div",w,[n("div",V,[x,o(n("input",{"onUpdate:modelValue":e[3]||(e[3]=e=>s.round.judgingStartedAt=e),type:"datetime-local",class:"form-control"},null,512),[[i,s.round.judgingStartedAt]])])]),n("div",I,[n("div",K,[M,o(n("input",{"onUpdate:modelValue":e[4]||(e[4]=e=>s.round.judgingEndedAt=e),type:"datetime-local",class:"form-control"},null,512),[[i,s.round.judgingEndedAt]])])]),n("div",_,[n("div",F,[N,o(n("input",{"onUpdate:modelValue":e[5]||(e[5]=e=>s.round.resultsAt=e),type:"datetime-local",class:"form-control"},null,512),[[i,s.round.resultsAt]])])])]),B,n("div",O,[n("div",q,[z,(d(!0),l(r,null,u(s.round.judgeToRounds,((e,t)=>(d(),l("div",{key:"judgeToRound-"+t},[c(m(e.user.username)+" - "+m(s.getJudgingTypeName(e.judgingTypeId))+" ",1),n("a",{href:"#",onClick:p((e=>s.removeJudge(t)),["prevent"])},[G],8,["onClick"])])))),128)),n("div",H,[o(n("input",{"onUpdate:modelValue":e[6]||(e[6]=e=>s.userKeyword=e),type:"text",placeholder:"username/id",class:"form-control",onKeyup:e[7]||(e[7]=g(((...e)=>s.search&&s.search(...e)),["enter"]))},null,544),[[i,s.userKeyword]]),n("button",{class:"btn btn-outline-primary",onClick:e[8]||(e[8]=(...e)=>s.search&&s.search(...e))},[L])]),(d(!0),l(r,null,u(s.users,(t=>(d(),l("div",{key:t.id,class:"form-check form-check-inline"},[o(n("input",{id:"user-"+t.id,"onUpdate:modelValue":e[9]||(e[9]=e=>s.selectedUser=e),class:"form-check-input",type:"radio",value:t},null,8,["id","value"]),[[f,s.selectedUser]]),n("label",{class:"form-check-label",for:"user-"+t.id},m(t.username),9,["for"])])))),128)),n("div",Q,[n("div",W,[o(n("input",{id:"mappersPick","onUpdate:modelValue":e[10]||(e[10]=e=>s.judgingTypeId=e),class:"form-check-input",type:"radio",value:s.mappersPick},null,8,["value"]),[[f,s.judgingTypeId]]),X]),n("div",Y,[o(n("input",{id:"playersPick","onUpdate:modelValue":e[11]||(e[11]=e=>s.judgingTypeId=e),class:"form-check-input",type:"radio",value:s.playersPick},null,8,["value"]),[[f,s.judgingTypeId]]),Z])]),n("button",{class:"btn btn-success",onClick:e[12]||(e[12]=(...e)=>s.addJudge&&s.addJudge(...e))}," Add ")])]),ss,n("div",es,[n("div",ts,[as,(d(!0),l(r,null,u(s.round.songs,((e,t)=>(d(),l("div",{key:"song-"+t},[c(m(e.title)+" - "+m(e.link)+" ",1),n("a",{href:"#",onClick:p((e=>s.removeSong(t)),["prevent"])},[ds],8,["onClick"])])))),128)),o(n("input",{"onUpdate:modelValue":e[13]||(e[13]=e=>s.title=e),type:"text",placeholder:"title",class:"form-control mb-2"},null,512),[[i,s.title]]),o(n("input",{"onUpdate:modelValue":e[14]||(e[14]=e=>s.link=e),type:"text",placeholder:"link",class:"form-control mb-2"},null,512),[[i,s.link]]),n("button",{class:"btn btn-success",onClick:e[15]||(e[15]=(...e)=>s.addSong&&s.addSong(...e))}," Add ")])])])])):b("",!0),n("div",ls,[ns,n("button",{type:"button",class:"btn btn-primary",onClick:e[16]||(e[16]=(...e)=>s.update&&s.update(...e))}," Save changes ")])])])])};var os=a({name:"StaffRounds",components:{DataTable:s,StaffRoundUpdate:k},data(){return{fields:["id",{key:"submissionsStartedAt",label:"Submissions Start",formatter:e.DateTimeString},{key:"submissionsEndedAt",label:"Submissions End",formatter:e.DateTimeString},{key:"judgingStartedAt",label:"Judging Start",formatter:e.DateTimeString},{key:"judgingEndedAt",label:"Judging End",formatter:e.DateTimeString},{key:"resultsAt",label:"Results",formatter:e.DateTimeString},{key:"judgeToRounds",label:"Judges",formatter:this.formatJudges},{key:"songs",label:"Songs",formatter:this.formatSongs}],rounds:[],selectedRound:null}},async created(){const{data:s}=await this.$http.get(`/api/contests/${this.$route.params.id}/rounds`);this.rounds=s},methods:{formatJudges:s=>s.map((s=>s.user.username)).join(", "),formatSongs:s=>s.map((s=>s.title)).join(", "),update(s){const e=this.rounds.findIndex((e=>e.id===s.id));-1!==e&&(this.rounds[e]=s)}}});const is={class:"container"},rs={class:"row"},us={class:"col-sm"},cs=c(" Submissions "),ms=c(" Judging ");os.render=function(s,e,t,a,o,i){const r=h("router-link"),u=h("data-table"),c=h("staff-round-update");return d(),l("div",is,[n("div",rs,[n("div",us,[n(u,{fields:s.fields,items:s.rounds},{actions:y((({item:e})=>[n("button",{class:"btn btn-sm btn-primary me-2","data-bs-toggle":"modal","data-bs-target":"#roundUpdate",onClick:t=>s.selectedRound=e}," Edit ",8,["onClick"]),n(r,{class:"btn btn-sm btn-link me-2",to:{name:"staff-submissions",params:{id:e.id}}},{default:y((()=>[cs])),_:2},1032,["to"]),n(r,{class:"btn btn-sm btn-link",to:{name:"staff-judging",params:{id:e.id}}},{default:y((()=>[ms])),_:2},1032,["to"])])),_:1},8,["fields","items"])])]),n(c,{id:"roundUpdate","round-prop":s.selectedRound,"onUpdate:round":e[1]||(e[1]=e=>s.update(e))},null,8,["round-prop"])])};export default os;
