var s=Object.defineProperty,e=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable,o=(e,t,a)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;import{_ as l}from"./DataTable.68439d7a.js";import{J as i,D as r}from"./index.046c61af.js";import{d as u,o as c,c as m,a as p,n as g,E as b,F as f,r as h,e as y,t as k,g as v,H as j,I as A,f as S,b as w,w as U}from"./vendor.4ebb0e4b.js";var E=u({name:"StaffRoundUpdate",props:{roundProp:{type:Object,default:()=>null}},emits:["update:round"],data:()=>({round:null,userKeyword:"",users:[],selectedUser:null,judgingTypeId:i.Mappers,title:"",link:""}),computed:{mappersPick:()=>i.Mappers,playersPick:()=>i.Players},watch:{roundProp(s){this.round=s?{submissionsStartedAt:this.$formatDate(s.submissionsStartedAt),submissionsEndedAt:this.$formatDate(s.submissionsEndedAt),judgingStartedAt:this.$formatDate(s.judgingStartedAt),judgingEndedAt:this.$formatDate(s.judgingEndedAt),resultsAt:this.$formatDate(s.resultsAt),judgeToRounds:[...s.judgeToRounds],songs:[...s.songs],downloadLink:s.downloadLink}:null}},methods:{getJudgingTypeName:s=>i[s],async search(){const{data:s}=await this.$http.get("/api/users?user="+this.userKeyword);this.users=s},addJudge(){if(this.round){if(!this.selectedUser)return this.$store.dispatch("addToastMessage","Select an user");this.round.judgeToRounds.push({user:this.selectedUser,judgingTypeId:this.judgingTypeId}),this.users=[]}},removeJudge(s){var e;null==(e=this.round)||e.judgeToRounds.splice(s,1)},addSong(){if(this.round)return this.title&&this.link?void this.round.songs.push({title:this.title,link:this.link}):this.$store.dispatch("addToastMessage","Fill the blanks")},removeSong(s){var e;null==(e=this.round)||e.songs.splice(s,1)},async update(){if(!this.round)return;const{data:s}=await this.$http.put(`/api/staff/rounds/${this.roundProp.id}`,(l=((s,e)=>{for(var t in e||(e={}))n.call(e,t)&&o(s,t,e[t]);if(a)for(var t of a(e))d.call(e,t)&&o(s,t,e[t]);return s})({},this.round),i={submissionsStartedAt:new Date(this.round.submissionsStartedAt),submissionsEndedAt:new Date(this.round.submissionsEndedAt),judgingStartedAt:new Date(this.round.judgingStartedAt),judgingEndedAt:new Date(this.round.judgingEndedAt),resultsAt:new Date(this.round.resultsAt),downloadLink:this.round.downloadLink},e(l,t(i))));var l,i;this.$emit("update:round",s)}}});const T={class:"modal fade",tabindex:"-1"},D={class:"modal-dialog modal-xl"},P={class:"modal-content"},J=p("div",{class:"modal-header"},[p("h5",{class:"modal-title"}," Update Round "),p("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),R={key:0,class:"modal-body"},L={class:"container"},$={class:"row mb-2"},C={class:"col-sm-6"},V={class:"form-group"},x=p("label",null,"Submissions Start Date",-1),I={class:"col-sm-6"},O={class:"form-group"},K=p("label",null,"Submissions End Date",-1),M={class:"col-sm-6"},_={class:"form-group"},F=p("label",null,"Judging Start Date",-1),N={class:"col-sm-6"},H={class:"form-group"},q=p("label",null,"Judging End Date",-1),z={class:"col-sm-6"},B={class:"form-group"},G=p("label",null,"Results Date",-1),Q=p("hr",null,null,-1),W={class:"row mb-2"},X={class:"col-sm"},Y=p("p",null,"Judges",-1),Z=p("i",{class:"fas fa-times text-danger"},null,-1),ss={class:"input-group"},es=p("i",{class:"fas fa-search"},null,-1),ts={class:"form-group"},as={class:"form-check form-check-inline"},ns=p("label",{class:"form-check-label",for:"mappersPick"},"Mapper",-1),ds={class:"form-check form-check-inline"},os=p("label",{class:"form-check-label",for:"playersPick"},"Player",-1),ls=p("hr",null,null,-1),is={class:"row"},rs={class:"col-sm"},us=p("p",null,"Songs",-1),cs=p("i",{class:"fas fa-times text-danger"},null,-1),ms=p("hr",null,null,-1),ps={class:"row"},gs={class:"col-sm"},bs={class:"modal-footer"},fs=p("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);E.render=function(s,e,t,a,n,d){return c(),m("div",T,[p("div",D,[p("div",P,[J,s.round?(c(),m("div",R,[p("div",L,[p("div",$,[p("div",C,[p("div",V,[x,g(p("input",{"onUpdate:modelValue":e[1]||(e[1]=e=>s.round.submissionsStartedAt=e),type:"datetime-local",class:"form-control"},null,512),[[b,s.round.submissionsStartedAt]])])]),p("div",I,[p("div",O,[K,g(p("input",{"onUpdate:modelValue":e[2]||(e[2]=e=>s.round.submissionsEndedAt=e),type:"datetime-local",class:"form-control"},null,512),[[b,s.round.submissionsEndedAt]])])]),p("div",M,[p("div",_,[F,g(p("input",{"onUpdate:modelValue":e[3]||(e[3]=e=>s.round.judgingStartedAt=e),type:"datetime-local",class:"form-control"},null,512),[[b,s.round.judgingStartedAt]])])]),p("div",N,[p("div",H,[q,g(p("input",{"onUpdate:modelValue":e[4]||(e[4]=e=>s.round.judgingEndedAt=e),type:"datetime-local",class:"form-control"},null,512),[[b,s.round.judgingEndedAt]])])]),p("div",z,[p("div",B,[G,g(p("input",{"onUpdate:modelValue":e[5]||(e[5]=e=>s.round.resultsAt=e),type:"datetime-local",class:"form-control"},null,512),[[b,s.round.resultsAt]])])])]),Q,p("div",W,[p("div",X,[Y,(c(!0),m(f,null,h(s.round.judgeToRounds,((e,t)=>(c(),m("div",{key:"judgeToRound-"+t},[y(k(e.user.username)+" - "+k(s.getJudgingTypeName(e.judgingTypeId))+" ",1),p("a",{href:"#",onClick:v((e=>s.removeJudge(t)),["prevent"])},[Z],8,["onClick"])])))),128)),p("div",ss,[g(p("input",{"onUpdate:modelValue":e[6]||(e[6]=e=>s.userKeyword=e),type:"text",placeholder:"username/id",class:"form-control",onKeyup:e[7]||(e[7]=j(((...e)=>s.search&&s.search(...e)),["enter"]))},null,544),[[b,s.userKeyword]]),p("button",{class:"btn btn-outline-primary",onClick:e[8]||(e[8]=(...e)=>s.search&&s.search(...e))},[es])]),(c(!0),m(f,null,h(s.users,(t=>(c(),m("div",{key:t.id,class:"form-check form-check-inline"},[g(p("input",{id:"user-"+t.id,"onUpdate:modelValue":e[9]||(e[9]=e=>s.selectedUser=e),class:"form-check-input",type:"radio",value:t},null,8,["id","value"]),[[A,s.selectedUser]]),p("label",{class:"form-check-label",for:"user-"+t.id},k(t.username),9,["for"])])))),128)),p("div",ts,[p("div",as,[g(p("input",{id:"mappersPick","onUpdate:modelValue":e[10]||(e[10]=e=>s.judgingTypeId=e),class:"form-check-input",type:"radio",value:s.mappersPick},null,8,["value"]),[[A,s.judgingTypeId]]),ns]),p("div",ds,[g(p("input",{id:"playersPick","onUpdate:modelValue":e[11]||(e[11]=e=>s.judgingTypeId=e),class:"form-check-input",type:"radio",value:s.playersPick},null,8,["value"]),[[A,s.judgingTypeId]]),os])]),p("button",{class:"btn btn-success",onClick:e[12]||(e[12]=(...e)=>s.addJudge&&s.addJudge(...e))}," Add ")])]),ls,p("div",is,[p("div",rs,[us,(c(!0),m(f,null,h(s.round.songs,((e,t)=>(c(),m("div",{key:"song-"+t},[y(k(e.title)+" - "+k(e.link)+" ",1),p("a",{href:"#",onClick:v((e=>s.removeSong(t)),["prevent"])},[cs],8,["onClick"])])))),128)),g(p("input",{"onUpdate:modelValue":e[13]||(e[13]=e=>s.title=e),type:"text",placeholder:"title",class:"form-control mb-2"},null,512),[[b,s.title]]),g(p("input",{"onUpdate:modelValue":e[14]||(e[14]=e=>s.link=e),type:"text",placeholder:"link",class:"form-control mb-2"},null,512),[[b,s.link]]),p("button",{class:"btn btn-success",onClick:e[15]||(e[15]=(...e)=>s.addSong&&s.addSong(...e))}," Add ")])]),ms,p("div",ps,[p("div",gs,[g(p("input",{"onUpdate:modelValue":e[16]||(e[16]=e=>s.round.downloadLink=e),type:"text",placeholder:"Link to download all submissions",class:"form-control"},null,512),[[b,s.round.downloadLink]])])])])])):S("",!0),p("div",bs,[fs,p("button",{type:"button",class:"btn btn-primary",onClick:e[17]||(e[17]=(...e)=>s.update&&s.update(...e))}," Save changes ")])])])])};var hs=u({name:"StaffRounds",components:{DataTable:l,StaffRoundUpdate:E},data(){return{fields:["id",{key:"submissionsStartedAt",label:"Submissions Start",formatter:r.Locale},{key:"submissionsEndedAt",label:"Submissions End",formatter:r.Locale},{key:"judgingStartedAt",label:"Judging Start",formatter:r.Locale},{key:"judgingEndedAt",label:"Judging End",formatter:r.Locale},{key:"resultsAt",label:"Results",formatter:r.Locale},{key:"judgeToRounds",label:"Judges",formatter:this.formatJudges},{key:"songs",label:"Songs",formatter:this.formatSongs},{key:"downloadLink",label:"Download All Link"}],rounds:[],selectedRound:null}},async created(){const{data:s}=await this.$http.get(`/api/contests/${this.$route.params.id}/rounds`);this.rounds=s},methods:{formatJudges:s=>s.map((s=>s.user.username)).join(", "),formatSongs:s=>s.map((s=>s.title)).join(", "),update(s){const e=this.rounds.findIndex((e=>e.id===s.id));-1!==e&&(this.rounds[e]=s)}}});const ys={class:"container"},ks={class:"row"},vs={class:"col-sm"},js=y(" Submissions "),As=y(" Judging ");hs.render=function(s,e,t,a,n,d){const o=w("router-link"),l=w("data-table"),i=w("staff-round-update");return c(),m("div",ys,[p("div",ks,[p("div",vs,[p(l,{fields:s.fields,items:s.rounds},{actions:U((({item:e})=>[p("button",{class:"btn btn-sm btn-primary me-2","data-bs-toggle":"modal","data-bs-target":"#roundUpdate",onClick:t=>s.selectedRound=e}," Edit ",8,["onClick"]),p(o,{class:"btn btn-sm btn-link me-2",to:{name:"staff-submissions",params:{id:e.id}}},{default:U((()=>[js])),_:2},1032,["to"]),p(o,{class:"btn btn-sm btn-link",to:{name:"staff-judging",params:{id:e.id}}},{default:U((()=>[As])),_:2},1032,["to"])])),_:1},8,["fields","items"])])]),p(i,{id:"roundUpdate","round-prop":s.selectedRound,"onUpdate:round":e[1]||(e[1]=e=>s.update(e))},null,8,["round-prop"])])};export default hs;
