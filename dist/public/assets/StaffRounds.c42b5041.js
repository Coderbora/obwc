var e=Object.defineProperty,s=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(s,t,a)=>t in s?e(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;import{_ as l}from"./DataTable.2986ebb1.js";import{J as r,D as i}from"./index.a02505d2.js";import{d as u,o as c,c as m,a as p,l as g,E as b,F as f,r as h,e as y,t as v,g as k,I as j,G as S,f as A,b as w,w as U}from"./vendor.28fcb284.js";var E=u({name:"StaffRoundUpdate",props:{roundProp:{type:Object,default:()=>null}},emits:["update:round"],data:()=>({round:null,userKeyword:"",users:[],selectedUser:null,judgingTypeId:r.Mappers,title:"",link:""}),computed:{mappersPick:()=>r.Mappers,playersPick:()=>r.Players},watch:{roundProp(e){this.round=e?{submissionsStartedAt:this.$formatDate(e.submissionsStartedAt),submissionsEndedAt:this.$formatDate(e.submissionsEndedAt),judgingStartedAt:this.$formatDate(e.judgingStartedAt),judgingEndedAt:this.$formatDate(e.judgingEndedAt),resultsAt:this.$formatDate(e.resultsAt),judgeToRounds:[...e.judgeToRounds],songs:[...e.songs]}:null}},methods:{getJudgingTypeName:e=>r[e],async search(){const{data:e}=await this.$http.get("/api/users?user="+this.userKeyword);this.users=e},addJudge(){if(this.round){if(!this.selectedUser)return this.$store.dispatch("addToastMessage","Select an user");this.round.judgeToRounds.push({user:this.selectedUser,judgingTypeId:this.judgingTypeId}),this.users=[]}},removeJudge(e){var s;null==(s=this.round)||s.judgeToRounds.splice(e,1)},addSong(){if(this.round)return this.title&&this.link?void this.round.songs.push({title:this.title,link:this.link}):this.$store.dispatch("addToastMessage","Fill the blanks")},removeSong(e){var s;null==(s=this.round)||s.songs.splice(e,1)},async update(){if(!this.round)return;const{data:e}=await this.$http.put(`/api/staff/rounds/${this.roundProp.id}`,(l=((e,s)=>{for(var t in s||(s={}))d.call(s,t)&&o(e,t,s[t]);if(a)for(var t of a(s))n.call(s,t)&&o(e,t,s[t]);return e})({},this.round),r={submissionsStartedAt:new Date(this.round.submissionsStartedAt),submissionsEndedAt:new Date(this.round.submissionsEndedAt),judgingStartedAt:new Date(this.round.judgingStartedAt),judgingEndedAt:new Date(this.round.judgingEndedAt),resultsAt:new Date(this.round.resultsAt)},s(l,t(r))));var l,r;this.$emit("update:round",e)}}});const T={class:"modal fade",tabindex:"-1"},D={class:"modal-dialog modal-xl"},P={class:"modal-content"},J=p("div",{class:"modal-header"},[p("h5",{class:"modal-title"}," Update Round "),p("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),R={key:0,class:"modal-body"},$={class:"container"},C={class:"row mb-2"},I={class:"col-sm-6"},V={class:"form-group"},x=p("label",null,"Submissions Start Date",-1),O={class:"col-sm-6"},K={class:"form-group"},L=p("label",null,"Submissions End Date",-1),M={class:"col-sm-6"},_={class:"form-group"},F=p("label",null,"Judging Start Date",-1),N={class:"col-sm-6"},G={class:"form-group"},q=p("label",null,"Judging End Date",-1),z={class:"col-sm-6"},B={class:"form-group"},H=p("label",null,"Results Date",-1),Q=p("hr",null,null,-1),W={class:"row mb-2"},X={class:"col-sm"},Y=p("p",null,"Judges",-1),Z=p("i",{class:"fas fa-times text-danger"},null,-1),ee={class:"input-group"},se=p("i",{class:"fas fa-search"},null,-1),te={class:"form-group"},ae={class:"form-check form-check-inline"},de=p("label",{class:"form-check-label",for:"mappersPick"},"Mapper",-1),ne={class:"form-check form-check-inline"},oe=p("label",{class:"form-check-label",for:"playersPick"},"Player",-1),le=p("hr",null,null,-1),re={class:"row"},ie={class:"col-sm"},ue=p("p",null,"Songs",-1),ce=p("i",{class:"fas fa-times text-danger"},null,-1),me={class:"modal-footer"},pe=p("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ",-1);E.render=function(e,s,t,a,d,n){return c(),m("div",T,[p("div",D,[p("div",P,[J,e.round?(c(),m("div",R,[p("div",$,[p("div",C,[p("div",I,[p("div",V,[x,g(p("input",{"onUpdate:modelValue":s[1]||(s[1]=s=>e.round.submissionsStartedAt=s),type:"datetime-local",class:"form-control"},null,512),[[b,e.round.submissionsStartedAt]])])]),p("div",O,[p("div",K,[L,g(p("input",{"onUpdate:modelValue":s[2]||(s[2]=s=>e.round.submissionsEndedAt=s),type:"datetime-local",class:"form-control"},null,512),[[b,e.round.submissionsEndedAt]])])]),p("div",M,[p("div",_,[F,g(p("input",{"onUpdate:modelValue":s[3]||(s[3]=s=>e.round.judgingStartedAt=s),type:"datetime-local",class:"form-control"},null,512),[[b,e.round.judgingStartedAt]])])]),p("div",N,[p("div",G,[q,g(p("input",{"onUpdate:modelValue":s[4]||(s[4]=s=>e.round.judgingEndedAt=s),type:"datetime-local",class:"form-control"},null,512),[[b,e.round.judgingEndedAt]])])]),p("div",z,[p("div",B,[H,g(p("input",{"onUpdate:modelValue":s[5]||(s[5]=s=>e.round.resultsAt=s),type:"datetime-local",class:"form-control"},null,512),[[b,e.round.resultsAt]])])])]),Q,p("div",W,[p("div",X,[Y,(c(!0),m(f,null,h(e.round.judgeToRounds,((s,t)=>(c(),m("div",{key:"judgeToRound-"+t},[y(v(s.user.username)+" - "+v(e.getJudgingTypeName(s.judgingTypeId))+" ",1),p("a",{href:"#",onClick:k((s=>e.removeJudge(t)),["prevent"])},[Z],8,["onClick"])])))),128)),p("div",ee,[g(p("input",{"onUpdate:modelValue":s[6]||(s[6]=s=>e.userKeyword=s),type:"text",placeholder:"username/id",class:"form-control",onKeyup:s[7]||(s[7]=j(((...s)=>e.search&&e.search(...s)),["enter"]))},null,544),[[b,e.userKeyword]]),p("button",{class:"btn btn-outline-primary",onClick:s[8]||(s[8]=(...s)=>e.search&&e.search(...s))},[se])]),(c(!0),m(f,null,h(e.users,(t=>(c(),m("div",{key:t.id,class:"form-check form-check-inline"},[g(p("input",{id:"user-"+t.id,"onUpdate:modelValue":s[9]||(s[9]=s=>e.selectedUser=s),class:"form-check-input",type:"radio",value:t},null,8,["id","value"]),[[S,e.selectedUser]]),p("label",{class:"form-check-label",for:"user-"+t.id},v(t.username),9,["for"])])))),128)),p("div",te,[p("div",ae,[g(p("input",{id:"mappersPick","onUpdate:modelValue":s[10]||(s[10]=s=>e.judgingTypeId=s),class:"form-check-input",type:"radio",value:e.mappersPick},null,8,["value"]),[[S,e.judgingTypeId]]),de]),p("div",ne,[g(p("input",{id:"playersPick","onUpdate:modelValue":s[11]||(s[11]=s=>e.judgingTypeId=s),class:"form-check-input",type:"radio",value:e.playersPick},null,8,["value"]),[[S,e.judgingTypeId]]),oe])]),p("button",{class:"btn btn-success",onClick:s[12]||(s[12]=(...s)=>e.addJudge&&e.addJudge(...s))}," Add ")])]),le,p("div",re,[p("div",ie,[ue,(c(!0),m(f,null,h(e.round.songs,((s,t)=>(c(),m("div",{key:"song-"+t},[y(v(s.title)+" - "+v(s.link)+" ",1),p("a",{href:"#",onClick:k((s=>e.removeSong(t)),["prevent"])},[ce],8,["onClick"])])))),128)),g(p("input",{"onUpdate:modelValue":s[13]||(s[13]=s=>e.title=s),type:"text",placeholder:"title",class:"form-control mb-2"},null,512),[[b,e.title]]),g(p("input",{"onUpdate:modelValue":s[14]||(s[14]=s=>e.link=s),type:"text",placeholder:"link",class:"form-control mb-2"},null,512),[[b,e.link]]),p("button",{class:"btn btn-success",onClick:s[15]||(s[15]=(...s)=>e.addSong&&e.addSong(...s))}," Add ")])])])])):A("",!0),p("div",me,[pe,p("button",{type:"button",class:"btn btn-primary",onClick:s[16]||(s[16]=(...s)=>e.update&&e.update(...s))}," Save changes ")])])])])};var ge=u({name:"StaffRounds",components:{DataTable:l,StaffRoundUpdate:E},data(){return{fields:["id",{key:"submissionsStartedAt",label:"Submissions Start",formatter:i.Locale},{key:"submissionsEndedAt",label:"Submissions End",formatter:i.Locale},{key:"judgingStartedAt",label:"Judging Start",formatter:i.Locale},{key:"judgingEndedAt",label:"Judging End",formatter:i.Locale},{key:"resultsAt",label:"Results",formatter:i.Locale},{key:"judgeToRounds",label:"Judges",formatter:this.formatJudges},{key:"songs",label:"Songs",formatter:this.formatSongs}],rounds:[],selectedRound:null}},async created(){const{data:e}=await this.$http.get(`/api/contests/${this.$route.params.id}/rounds`);this.rounds=e},methods:{formatJudges:e=>e.map((e=>e.user.username)).join(", "),formatSongs:e=>e.map((e=>e.title)).join(", "),update(e){const s=this.rounds.findIndex((s=>s.id===e.id));-1!==s&&(this.rounds[s]=e)}}});const be={class:"container"},fe={class:"row"},he={class:"col-sm"},ye=y(" Submissions "),ve=y(" Judging ");ge.render=function(e,s,t,a,d,n){const o=w("router-link"),l=w("data-table"),r=w("staff-round-update");return c(),m("div",be,[p("div",fe,[p("div",he,[p(l,{fields:e.fields,items:e.rounds},{actions:U((({item:s})=>[p("button",{class:"btn btn-sm btn-primary me-2","data-bs-toggle":"modal","data-bs-target":"#roundUpdate",onClick:t=>e.selectedRound=s}," Edit ",8,["onClick"]),p(o,{class:"btn btn-sm btn-link me-2",to:{name:"staff-submissions",params:{id:s.id}}},{default:U((()=>[ye])),_:2},1032,["to"]),p(o,{class:"btn btn-sm btn-link",to:{name:"staff-judging",params:{id:s.id}}},{default:U((()=>[ve])),_:2},1032,["to"])])),_:1},8,["fields","items"])])]),p(r,{id:"roundUpdate","round-prop":e.selectedRound,"onUpdate:round":s[1]||(s[1]=s=>e.update(s))},null,8,["round-prop"])])};export default ge;
