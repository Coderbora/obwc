var s=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,e=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,o=(t,a,e)=>a in t?s(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e;import{d as r,m as l,b as d,o as u,c,a as m,f as p,F as b,r as h,e as f,t as v,l as g,A as y}from"./vendor.6e598276.js";import{_ as w}from"./DataTable.ab8426c4.js";import{_ as S,D as k,a as F}from"./index.91aa5a19.js";var O,R,j=r({components:{DataTable:w,TimeString:S},data:()=>({submissions:[],oszFile:null,information:"",isSaving:!1,fields:[{key:"round",label:"Round",formatter:s=>s.id},{key:"updatedAt",label:"Update Date",formatter:k.Locale}]}),computed:(O=((s,t)=>{for(var a in t||(t={}))i.call(t,a)&&o(s,a,t[a]);if(e)for(var a of e(t))n.call(t,a)&&o(s,a,t[a]);return s})({},l({user:s=>s.loggedInUser,rounds:s=>s.rounds})),R={standardContest(){return this.$store.getters.standardContest},currentRound(){return this.$store.getters.currentSubmissionRound},currentSubmission(){return this.submissions.find((s=>{var t;return s.round.id===(null==(t=this.currentRound)?void 0:t.id)}))}},t(O,a(R))),async created(){var s;await this.getData(),this.information=(null==(s=this.currentSubmission)?void 0:s.information)||""},methods:{async getData(){const{data:s}=await this.$http.get("/api/submissions");this.submissions=s,this.rounds.length||await this.$store.dispatch(F,this.standardContest.id)},async save(s){if(!this.oszFile)return void this.$store.dispatch("addToastMessage","Select an .osz");if(!this.information)return void this.$store.dispatch("addToastMessage","Add details about your entry");this.$store.dispatch("addToastMessage",{type:"info",message:"This may take a couple of minutes"}),(null==s?void 0:s.target).disabled=!0,this.isSaving=!0;const t=new FormData;t.append("oszFile",this.oszFile),t.append("information",this.information),await this.$http.post("/api/submissions",t,{headers:{"Content-Type":"multipart/form-data"}}).finally((()=>{this.isSaving=!1,(null==s?void 0:s.target).disabled=!1})),await this.getData()},uploadFile(s){var t,a;this.oszFile=null==(a=null==(t=s.target)?void 0:t.files)?void 0:a[0]}}});const z={class:"container-fluid"},D={class:"card card-section"},T=m("div",{class:"card-header"},[m("div",{class:"card-header-back"}," Submissions "),m("div",{class:"card-header-sub"},[m("div",{class:"card-header-title"}," SUBMISSIONS ")])],-1),$={class:"card-body"},x={class:"container"},A={class:"row"},C={class:"col-sm"},M=m("hr",null,null,-1),P={class:"row mb-3"},I={class:"col-sm"},U={class:"text-center"},_=f(" You have from "),E=f(" to "),L=f(" to submit your entry "),B=m("hr",null,null,-1),N={key:0,class:"text-center"},V=m("i",{class:"fas fa-file-download"},null,-1),Y=m("hr",null,null,-1),q=m("label",{for:"oszFile",class:"form-label"},".osz File (30Mb max)",-1),G={class:"row"},H={class:"col-sm"},J={key:0,class:"spinner-border spinner-border-sm align-middle",role:"status"},K=m("span",{class:"sr-only"},"Loading...",-1),Q={key:1},W=m("i",{class:"fas fa-save"},null,-1),X=f(" Save ");j.render=function(s,t,a,e,i,n){const o=d("data-table"),r=d("time-string");return u(),c("div",z,[m("div",D,[T,m("div",$,[m("div",x,[m("div",A,[m("div",C,[s.submissions?(u(),c(o,{key:0,fields:s.fields,items:s.submissions},null,8,["fields","items"])):p("",!0)])]),s.currentRound?(u(),c(b,{key:0},[M,m("div",P,[m("div",I,[m("p",U,[_,m("b",null,[m(r,{timestamp:s.currentRound.submissionsStartedAt},null,8,["timestamp"])]),E,m("b",null,[m(r,{timestamp:s.currentRound.submissionsEndedAt},null,8,["timestamp"])]),L]),B,s.currentRound.songs&&s.currentRound.songs.length?(u(),c("div",N,[(u(!0),c(b,null,h(s.currentRound.songs,(s=>(u(),c("p",{key:s},[m("a",{href:s.link,target:"_blank"},[f(v(s.title)+" ",1),V],8,["href"])])))),128))])):p("",!0),Y,g(m("textarea",{"onUpdate:modelValue":t[1]||(t[1]=t=>s.information=t),class:"form-control mb-2",rows:"5",placeholder:"Add details on how people participated on this entry"},null,512),[[y,s.information]]),m("div",null,[q,m("input",{id:"oszFile",class:"form-control",type:"file",onChange:t[2]||(t[2]=t=>s.uploadFile(t))},null,32)])])]),m("div",G,[m("div",H,[m("button",{class:"btn btn-yellow w-100",onClick:t[3]||(t[3]=t=>s.save(t))},[s.isSaving?(u(),c("div",J,[K])):(u(),c("span",Q,[W,X]))])])])],64)):p("",!0)])])])])};export default j;
