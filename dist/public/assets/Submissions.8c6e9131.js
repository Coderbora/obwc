import{d as s,m as a,b as t,o as e,c as i,a as l,f as n,F as o,e as d}from"./vendor.6e598276.js";import{_ as r,F as u}from"./DataTable.9d75468e.js";import{_ as c,a as m}from"./index.ca149da2.js";var b=s({components:{DataTable:r,TimeString:c},data:()=>({submissions:[],oszFile:null,isSaving:!1,fields:[{key:"round",label:"Round",formatter:s=>s.id},{key:"updatedAt",label:"Update Date",formatter:u.DateTimeString}]}),computed:a({user:s=>s.loggedInUser,rounds:s=>s.rounds,standardContest(){return this.$store.getters.standardContest},currentRound(){return this.$store.getters.currentSubmissionRound}}),async created(){await this.getData()},methods:{async getData(){const{data:s}=await this.$http.get("/api/submissions");this.submissions=s,this.rounds.length||await this.$store.dispatch(m,this.standardContest.id)},async save(s){if(!this.oszFile)return void this.$store.dispatch("addToastMessage","Select an .osz");(null==s?void 0:s.target).disabled=!0,this.isSaving=!0;const a=new FormData;a.append("oszFile",this.oszFile),await this.$http.post("/api/submissions",a,{headers:{"Content-Type":"multipart/form-data"}}).finally((()=>{this.isSaving=!1,(null==s?void 0:s.target).disabled=!1})),await this.getData()},uploadFile(s){var a,t;this.oszFile=null==(t=null==(a=s.target)?void 0:a.files)?void 0:t[0]}}});const v={class:"container-fluid"},p={class:"card card-section"},h=l("div",{class:"card-header"},[l("div",{class:"card-header-back"}," Submissions "),l("div",{class:"card-header-sub"},[l("div",{class:"card-header-title"}," SUBMISSIONS ")])],-1),f={class:"card-body"},g={class:"container"},y={class:"row"},S={class:"col-sm"},F=l("hr",null,null,-1),w={class:"row mb-3"},z={class:"col-sm"},k={class:"text-center"},D=d(" You have from "),C=d(" to "),R=d(" to submit your entry "),T=l("hr",null,null,-1),$=l("label",{for:"oszFile",class:"form-label"},".osz File (15Mb max)",-1),x={class:"row"},j={class:"col-sm"},A={key:0,class:"spinner-border spinner-border-sm align-middle",role:"status"},I=l("span",{class:"sr-only"},"Loading...",-1),M={key:1},U=l("i",{class:"fas fa-save"},null,-1),_=d(" Save ");b.render=function(s,a,d,r,u,c){const m=t("data-table"),b=t("time-string");return e(),i("div",v,[l("div",p,[h,l("div",f,[l("div",g,[l("div",y,[l("div",S,[s.submissions?(e(),i(m,{key:0,fields:s.fields,items:s.submissions},null,8,["fields","items"])):n("",!0)])]),s.currentRound?(e(),i(o,{key:0},[F,l("div",w,[l("div",z,[l("p",k,[D,l("b",null,[l(b,{timestamp:s.currentRound.submissionsStartedAt},null,8,["timestamp"])]),C,l("b",null,[l(b,{timestamp:s.currentRound.submissionsEndedAt},null,8,["timestamp"])]),R]),T,l("div",null,[$,l("input",{id:"oszFile",class:"form-control",type:"file",onChange:a[1]||(a[1]=a=>s.uploadFile(a))},null,32)])])]),l("div",x,[l("div",j,[l("button",{class:"btn btn-yellow w-100",onClick:a[2]||(a[2]=a=>s.save(a))},[s.isSaving?(e(),i("div",A,[I])):(e(),i("span",M,[U,_]))])])])],64)):n("",!0)])])])])};export default b;
